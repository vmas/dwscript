<html>
<head>
<title>Uses test</title>
</head>
<body><%
uses System.Info;

function Pretty(i : Integer) : String;
begin
   Result:=Format('%.1f MiB', [i/(1024*1024)]);
end;

function Bar(const d : MemoryStatusDetail) : String;
begin
   Result:= '<div><div class="bar" style="width:'
           +IntToStr(100-Round(100*d.Available/d.Total))
           +'%">'
end;

var ms := new MemoryStatus;

%>
<style>
td, th {
   font-family : "Segoe UI" Helvetica Arial;
   color : #039;
   border-bottom : 1px solid #ABC;
}
th {
   border-bottom : 2px solid #039;
}
td + td {
   text-align : right;
}
div {
   background-color : #DDF;
   width : 150;
}
div.bar {
   background-color : #88F;
   height : 11;
}
</style>
<h4><%=OSVersionInfo.Name%></h4>
<table cellspacing="0" cellpadding="6">
   <tr>
      <th>Memory
      <th>Available
      <th>Total
      <th>Ratio
   <tr>
      <td>Physical
      <td><%=Pretty(ms.Physical.Available)%>
      <td><%=Pretty(ms.Physical.Total)%>
      <td><%=Bar(ms.Physical)%>
   <tr>
      <td>Virtual
      <td><%=Pretty(ms.Virtual.Available)%>
      <td><%=Pretty(ms.Virtual.Total)%>
      <td><%=Bar(ms.Virtual)%>
   <tr>
      <td>PageFile
      <td><%=Pretty(ms.PageFile.Available)%>
      <td><%=Pretty(ms.PageFile.Total)%>
      <td><%=Bar(ms.PageFile)%>
</table>
</body>
</html>